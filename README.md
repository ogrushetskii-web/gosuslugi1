# Семейный портал госуслуг

Полноценный монорепозиторий семейного портала: клиент на React + Tailwind, сервер на Express + Prisma, демо-данные и инфраструктурные скрипты.

## Стек

- **Клиент**: React 18 (Vite), Tailwind CSS с градиентами, React Router, Zustand, i18next, PWA.
- **Сервер**: Node.js + Express, Prisma ORM, SQLite (по умолчанию) с возможностью перехода на PostgreSQL, Socket.IO для пуш-уведомлений.
- **Общее**: TypeScript, Vitest, ESLint/Prettier, Docker.

## Структура

```
client/   # Vite-приложение, Tailwind тема, PWA и тесты
server/   # Express API, Prisma-схемы, контроллеры, сервисы, WebSocket
```

## Запуск

```bash
npm install
npm run prisma:generate
npm run dev        # стартует клиент (порт 5173)
npm run dev:server # стартует API (порт 4000)
```

### Миграции и демоданные

```bash
cd server
cp .env.example .env
npx prisma migrate dev
npx ts-node prisma/seed.ts
```

## Скрипты

- `npm run build` — сборка клиента и сервера.
- `npm run lint` / `npm run format` — проверка стиля.
- `npm run test` — Vitest для клиента и сервера.
- `npm run prisma:generate` — генерация Prisma клиента.

## Docker

- `client/Dockerfile` — сборка статического фронтенда.
- `server/Dockerfile` — сборка API с компиляцией TypeScript.

## Архитектура сервера

- `routes` — REST-эндпоинты: аутентификация, дела, документы, задачи, уведомления, экспорт, журнал.
- `services` — бизнес-логика (OCR документов через `tesseract.js`, автотеги, TOTP, экспорт).
- `validators` — Zod-схемы ввода.
- `websocket` — Socket.IO вещание уведомлений.
- `prisma/schema.prisma` — сущности: семья, пользователь, дело, документ, задача, напоминание, ведомство, тег, комментарий, история действий, уведомление, шаблон письма, настройки безопасности.

## Интерфейс

Клиент воспроизводит референсный дашборд: шапка с двумя аватарами, глобальным поиском, индикатором безопасности и переключателем тем, KPI-карточки, карточки дел с прогрессом, сетка документов с дропзоной, боковая панель задач/календаря/уведомлений, поддержка светлой и тёмной темы.

## Локализация и доступность

Поддержка `ru`, `en`, `nl` через i18next, элементы снабжены aria-атрибутами, клавиатурные состояния и фокус стилизованы Tailwind-классами.

## Фичефлаги

В `.env` предусмотрены переменные для почтового парсера и интеграций с S3-совместимыми хранилищами; по умолчанию используются локальные заглушки.
